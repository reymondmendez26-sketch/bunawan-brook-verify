<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Add / Edit Member</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#111;
  color:#fff;
  font-family:Arial;
  padding:20px;
}
.container{
  max-width:600px;
  margin:auto;
  background:#222;
  padding:25px;
  border-radius:14px;
}
h2{text-align:center}
input,select,textarea,button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:none;
  font-size:14px;
}
button{
  background:#caa24d;
  font-weight:bold;
  cursor:pointer;
}
textarea{resize:vertical}
label{font-size:13px;opacity:.8}
</style>
</head>

<body>

<script>
if(sessionStorage.getItem("bbc_admin")!=="true"){
  window.location.href="admin-login.html";
}
</script>

<div class="container">
<h2 id="title">Add Member</h2>

<label>Full Name</label>
<input id="fullname">

<label>Alexis / Medusa Name</label>
<input id="alexis">

<label>Date Survive</label>
<input type="date" id="date">

<label>Status</label>
<select id="status">
  <option>ACTIVE</option>
  <option>INACTIVE</option>
  <option>SUSPENDED</option>
  <option>EXPELLED</option>
</select>

<label>Position</label>
<select id="position">
  <option>Current GT</option>
  <option>Former GT</option>
  <option>Organizer</option>
  <option>MKS</option>
  <option>MKC</option>
  <option>Member</option>
  <option>Adviser</option>
  <option>7 Master</option>
</select>

<label>Remarks</label>
<textarea id="remarks"></textarea>

<label>Photo</label>
<input type="file" id="photo">

<label>Certificate of Legitimacy (PDF/JPG/PNG)</label>
<input type="file" id="col">

<label>Other Certificates (Multiple)</label>
<input type="file" id="others" multiple>

<button onclick="save()">Save Member</button>
<button onclick="generateID()">Generate ID</button>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzm9kXBRRFWT60ngW0VjQoDZba4ynjrE2E1Cw23Ybb1783FuTLl7P9K6mrrYZS3gwg_/exec";
const params = new URLSearchParams(window.location.search);
const mode = params.get("mode");
const token = params.get("t");

if(mode==="edit"){
  document.getElementById("title").innerText="Edit Member";
  loadMember();
}

function loadMember(){
  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      action:"getMember",
      token: token
    })
  })
  .then(r=>r.json())
  .then(m=>{
    if(!m || !m.fullname){
      alert("Failed to load member");
      return;
    }

    document.getElementById("fullname").value = m.fullname || "";
    document.getElementById("alexis").value   = m.alexis || "";
    document.getElementById("date").value     = m.date || "";
    document.getElementById("status").value   = m.status || "ACTIVE";
    document.getElementById("position").value = m.position || "Member";
    document.getElementById("remarks").value  = m.remarks || "";
  });
}

function save(){
  fetch(API_URL,{
    method:"POST",
    body:JSON.stringify({
      action:"saveMember",
      mode:mode,
      token:token,
      fullname:fullname.value,
      alexis:alexis.value,
      date:date.value,
      status:status.value,
      position:position.value,
      remarks:remarks.value
    })
  })
  .then(r=>r.json())
  .then(res=>{
    alert(res.success?"Saved":"Error");
    if(res.success) window.location.href="admin-dashboard.html";
  });
}

function generateID(){
  alert("ID generation next step");
}
</script>

</body>
</html>
